
<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Calibrators &#8212; euv_fitting [0.2.0] documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="_static/thebelab.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/thebelab-helper.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'calibration';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Uncertainties" href="uncertainty.html" />
    <link rel="prev" title="Peak Fitters" href="peakfitting.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  <div class="navbar-header-items__start">
    
      <div class="navbar-item">
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
    <p class="title logo__title">euv_fitting [0.2.0] documentation</p>
  
</a></div>
    
  </div>
  
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="intro.html">
                        Introduction
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="peakfitting.html">
                        Peak Fitters
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="#">
                        Calibrators
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="uncertainty.html">
                        Uncertainties
                      </a>
                    </li>
                
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
        </div>
      
      
        <div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar hide-on-wide">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="intro.html">
                        Introduction
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="peakfitting.html">
                        Peak Fitters
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="#">
                        Calibrators
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="uncertainty.html">
                        Uncertainties
                      </a>
                    </li>
                
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
        
      </div>
    
  </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumbs">
  <ul class="bd-breadcrumbs" role="navigation" aria-label="Breadcrumb">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page">Calibrators</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <span class="target" id="module-euv_fitting.calibrate.calibrators"><span id="calibration-chapter"></span></span><section id="calibrators">
<h1>Calibrators<a class="headerlink" href="#calibrators" title="Permalink to this heading">#</a></h1>
<p>The main focus of the euv_fitting package is finding the calibration, or the
relationship between channel number and wavelength.</p>
<section id="calibration-process">
<h2>Calibration Process<a class="headerlink" href="#calibration-process" title="Permalink to this heading">#</a></h2>
<p>Each calibration line will have a certain channel position (given by the peak fitting)
and a wavelength. If we make a graph with channel position on the x-axis and
wavelength on the y-axis, a line at channel number 1000 and an 8.8 nm wavelength
looks like this:</p>
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
<img alt="_images/calibration_0_0.png" src="_images/calibration_0_0.png" />
</div>
</div>
<p>The channel uncertainty is calculated in the peak fitting process, while the wavelength
comes from the literature source for that line. For a more detailed description of
how uncertainties and outliers are handled, see the uncertainties page.</p>
<p>If multiple calibration lines have been identified, that gives us many
(x, y) points we can use to estimate the calibration curve. The <cite>Calibrator</cite>
class stores identified calibration lines in <cite>Calibrator.solution_arr</cite>.
.solution_arr has the shape (N x 4), where N is the number of calibration lines used.
Each row has the form [wavelength, wavelength_uncertainty, channel, channel_uncertainty].</p>
<p>As an example, consider these neon and background spectra which were taken at roughly the same time:</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">euv_fitting.calibrate.utils</span> <span class="kn">import</span> <span class="n">SpeReader</span><span class="p">,</span> <span class="n">CosmicRayFilter</span>
<span class="kn">from</span> <span class="nn">euv_fitting.calibrate.calibrators</span> <span class="kn">import</span> <span class="n">Distance_Calibrator</span>

<span class="n">CRF</span> <span class="o">=</span> <span class="n">CosmicRayFilter</span><span class="p">()</span>

<span class="n">Ne_spe</span> <span class="o">=</span> <span class="n">SpeReader</span><span class="p">(</span><span class="s1">&#39;./example_data/Example_Neon.SPE&#39;</span><span class="p">)</span>
<span class="n">Bkg_spe</span> <span class="o">=</span> <span class="n">SpeReader</span><span class="p">(</span><span class="s1">&#39;./example_data/Example_Background.SPE&#39;</span><span class="p">)</span>

<span class="n">Ne_img</span> <span class="o">=</span> <span class="n">CRF</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">Ne_spe</span><span class="o">.</span><span class="n">load_img</span><span class="p">())</span>
<span class="n">Bkg_img</span> <span class="o">=</span> <span class="n">CRF</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">Bkg_spe</span><span class="o">.</span><span class="n">load_img</span><span class="p">())</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Ne_img</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Ne&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Bkg_img</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Bkg&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Channel&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/calibration_1_0.png" src="_images/calibration_1_0.png" />
</div>
</div>
<p>To identify the lines in these spectra, we create <cite>Distance_Calibrator</cite> objects
and call their <cite>.calibrate</cite> method.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Ne_cal</span> <span class="o">=</span> <span class="n">Distance_Calibrator</span><span class="p">(</span><span class="n">Ne_img</span><span class="p">,</span> <span class="s1">&#39;Ne&#39;</span><span class="p">,</span> <span class="n">num_peaks</span> <span class="o">=</span> <span class="mi">25</span><span class="p">)</span> <span class="c1">#specify element and #peaks</span>
<span class="n">Bkg_cal</span> <span class="o">=</span> <span class="n">Distance_Calibrator</span><span class="p">(</span><span class="n">Bkg_img</span><span class="p">,</span> <span class="s1">&#39;Ba&#39;</span><span class="p">,</span> <span class="n">num_peaks</span> <span class="o">=</span> <span class="mi">25</span><span class="p">)</span> <span class="c1">#specify element and #peaks</span>

<span class="n">Ne_cal</span><span class="o">.</span><span class="n">calibrate</span><span class="p">()</span>
<span class="n">Bkg_cal</span><span class="o">.</span><span class="n">calibrate</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Neon Solution Array&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Ne_cal</span><span class="o">.</span><span class="n">solution_arr</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Background Solution Array&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Bkg_cal</span><span class="o">.</span><span class="n">solution_arr</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>selecting best peaks
selecting best peaks
</pre></div>
</div>
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>Neon Solution Array
[[8.80929000e+00 1.40000000e-04 7.62421231e+02 2.58781802e-02]
 [9.75020000e+00 4.00000000e-04 8.90567351e+02 3.55102613e-02]
 [1.11136000e+01 1.80000000e-03 1.06748262e+03 3.36749072e-02]
 [1.16691000e+01 5.00000000e-04 1.13674959e+03 2.73318275e-02]
 [1.27676000e+01 7.00000000e-04 1.26986371e+03 1.56628562e-02]
 [1.43314000e+01 7.00000000e-04 1.45125753e+03 2.30675110e-02]
 [1.47138000e+01 7.00000000e-04 1.49425996e+03 4.19253220e-02]
 [1.76186000e+01 2.80000000e-04 1.80726417e+03 2.92112055e-02]
 [1.95004000e+01 8.00000000e-04 1.99888699e+03 2.73615248e-02]]
Background Solution Array
[[5.21540000e+00 2.50000000e-03 2.09996430e+02 6.03119420e-02]
 [5.67700000e+00 1.00000000e-03 2.88094113e+02 4.50670806e-02]
 [5.98460000e+00 2.00000000e-04 3.38510633e+02 7.24005140e-02]
 [6.16220000e+00 2.50000000e-03 3.67006855e+02 9.25922924e-02]
 [6.28800000e+00 3.00000000e-03 3.88270099e+02 5.29248232e-02]
 [6.66230000e+00 7.00000000e-04 4.46800576e+02 3.19296907e-02]
 [1.17686000e+01 1.00000000e-03 1.14876942e+03 3.39887742e-02]
 [1.23920000e+01 3.00000000e-03 1.22513586e+03 2.31265415e-02]
 [1.25818000e+01 5.00000000e-03 1.24772767e+03 4.11585546e-02]
 [1.29930000e+01 3.00000000e-03 1.29716876e+03 3.89691709e-02]
 [1.33246000e+01 1.40000000e-03 1.33537973e+03 5.23796173e-02]
 [1.50101000e+01 5.00000000e-04 1.52770709e+03 3.52752553e-02]
 [1.72169000e+01 3.00000000e-04 1.76518033e+03 8.77637881e-02]
 [1.73081000e+01 5.00000000e-04 1.77455803e+03 1.19250428e-01]]
</pre></div>
</div>
</div>
</div>
<p>If we were to use each of these files <em>individually</em>, we would only get part of
the story; In general, Neon files have more calibration lines in the high wavelength
region, while Background files fill out the lower wavelengths. To take advantage
of all information, we can join these two calibrators together:</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Ne_cal</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">Bkg_cal</span><span class="p">])</span> <span class="c1">#Could add more calibrators if available to this list.</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Total Solution Array&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Ne_cal</span><span class="o">.</span><span class="n">solution_arr</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>Total Solution Array
[[8.80929000e+00 1.40000000e-04 7.62421231e+02 2.58781802e-02]
 [9.75020000e+00 4.00000000e-04 8.90567351e+02 3.55102613e-02]
 [1.11136000e+01 1.80000000e-03 1.06748262e+03 3.36749072e-02]
 [1.16691000e+01 5.00000000e-04 1.13674959e+03 2.73318275e-02]
 [1.27676000e+01 7.00000000e-04 1.26986371e+03 1.56628562e-02]
 [1.43314000e+01 7.00000000e-04 1.45125753e+03 2.30675110e-02]
 [1.47138000e+01 7.00000000e-04 1.49425996e+03 4.19253220e-02]
 [1.76186000e+01 2.80000000e-04 1.80726417e+03 2.92112055e-02]
 [1.95004000e+01 8.00000000e-04 1.99888699e+03 2.73615248e-02]
 [5.21540000e+00 2.50000000e-03 2.09996430e+02 6.03119420e-02]
 [5.67700000e+00 1.00000000e-03 2.88094113e+02 4.50670806e-02]
 [5.98460000e+00 2.00000000e-04 3.38510633e+02 7.24005140e-02]
 [6.16220000e+00 2.50000000e-03 3.67006855e+02 9.25922924e-02]
 [6.28800000e+00 3.00000000e-03 3.88270099e+02 5.29248232e-02]
 [6.66230000e+00 7.00000000e-04 4.46800576e+02 3.19296907e-02]
 [1.17686000e+01 1.00000000e-03 1.14876942e+03 3.39887742e-02]
 [1.23920000e+01 3.00000000e-03 1.22513586e+03 2.31265415e-02]
 [1.25818000e+01 5.00000000e-03 1.24772767e+03 4.11585546e-02]
 [1.29930000e+01 3.00000000e-03 1.29716876e+03 3.89691709e-02]
 [1.33246000e+01 1.40000000e-03 1.33537973e+03 5.23796173e-02]
 [1.50101000e+01 5.00000000e-04 1.52770709e+03 3.52752553e-02]
 [1.72169000e+01 3.00000000e-04 1.76518033e+03 8.77637881e-02]
 [1.73081000e+01 5.00000000e-04 1.77455803e+03 1.19250428e-01]]
</pre></div>
</div>
</div>
</div>
<p>The <cite>Calibrator</cite> class also handles calculating the calibration from that array.
The final step is to call the <cite>.fit()</cite> method and print out information about how
the fit went.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Ne_cal</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">Ne_cal</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">Ne_cal</span><span class="o">.</span><span class="n">residual_plot</span><span class="p">()</span>
<span class="n">Ne_cal</span><span class="o">.</span><span class="n">print_info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/calibration_4_0.png" src="_images/calibration_4_0.png" />
<img alt="_images/calibration_4_1.png" src="_images/calibration_4_1.png" />
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>K0 = 4.051760979290335±0.003037473135061028
K1 = 0.005274290727274932±1.1718352123140706e-05
K2 = 1.2887169025469727e-06±1.2352525685988656e-08
K3 = -2.9330230066183045e-11±3.842164006338311e-12
Highest/Average channel uncertainty 1.14e-03 / 3.63e-04
Highest/Average wavelength uncertainty 5.00e-03 / 1.36e-03
Systematic Uncertainty: 0.0010382812499999975
Unadjusted Chi-square: 2.41881744438093
</pre></div>
</div>
</div>
</div>
</section>
<section id="calibrator">
<h2><a class="reference internal" href="#euv_fitting.calibrate.calibrators.Calibrator" title="euv_fitting.calibrate.calibrators.Calibrator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Calibrator</span></code></a><a class="headerlink" href="#calibrator" title="Permalink to this heading">#</a></h2>
<p>Includes general calibration functionality such as uncertainty analysis,
intensity calibration, printing, and plotting.</p>
<blockquote>
<div><dl class="py class">
<dt class="sig sig-object py" id="euv_fitting.calibrate.calibrators.Calibrator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Calibrator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#euv_fitting.calibrate.calibrators.Calibrator" title="Permalink to this definition">#</a></dt>
<dd><p>Parent class of DistanceCalibrator and DFSCalibrator. Includes uncertainty analysis,
plotting, and outlier detection for final analysis.</p>
<p>If initializing from array, the calibrator class by itself expects the format:
[[y, y_uncertainty, x, x_uncertainty],
[y, y_uncertainty, x, x_uncertainty],
[y, y_uncertainty, x, x_uncertainty]]</p>
<dl class="py method">
<dt class="sig sig-object py" id="euv_fitting.calibrate.calibrators.Calibrator.confidence_bands">
<span class="sig-name descname"><span class="pre">confidence_bands</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#euv_fitting.calibrate.calibrators.Calibrator.confidence_bands" title="Permalink to this definition">#</a></dt>
<dd><p>Finds confidence bands at each wavelength and stores it in self.cb</p>
<p>Inputs:
n_sigma: float, number of sigma for bands
func: calibration function</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="euv_fitting.calibrate.calibrators.Calibrator.eval_chi_square">
<span class="sig-name descname"><span class="pre">eval_chi_square</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#euv_fitting.calibrate.calibrators.Calibrator.eval_chi_square" title="Permalink to this definition">#</a></dt>
<dd><p>Finds distance of chi-squared from target given systematic uncertainty i</p>
<p>Parameters:</p>
<dl>
<dt>i: float</dt><dd><p>Systematic uncertainty</p>
</dd>
<dt>func: callable</dt><dd><p>Calibration function, takes in x and returns y. Must have the signature:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">func</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span><span class="o">.</span>
</pre></div>
</div>
</dd>
<dt>target: float</dt><dd><p>goal value of chi-squared</p>
</dd>
<dt>verbose: boolean</dt><dd><p>If true, print out additional information during the fitting process.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="euv_fitting.calibrate.calibrators.Calibrator.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outlier_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">const_uncertainty</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#euv_fitting.calibrate.calibrators.Calibrator.fit" title="Permalink to this definition">#</a></dt>
<dd><p>Main call of the calibrator class. Computes the calibration coefficients and covariance.</p>
<p>This function should only be called after the .calibrate method. It relies on data
stored on self.solution_arr and self.order_data to be present. It completes automatic outlier removal,
can penalize first and second order line differences, and calculates confidence bands of the resulting fit.</p>
<p>After this call, the following attributes are created:</p>
<p>self.popt - coefficients of the calibration function.</p>
<p>self.pcov - covariance matrix of the fit.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>func</strong> (<em>callable</em>) – <p>Calibration function, takes in x and returns y. Must have the signature:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">func</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span><span class="o">.</span>
</pre></div>
</div>
</p></li>
<li><p><strong>outlier_sigma</strong> (<em>{float</em><em>, </em><em>None}</em>) – Number of sigmas away a point can be before being removed. Lower
values indicate more aggressive outlier removal. See the
remove_outliers function for more details. If None, no outlier
removal is completed.</p></li>
<li><p><strong>iterations</strong> (<em>int</em>) – Number of iterations of intensity calibration to complete. This
uses the calibration function from the previous function to weight
peak fitting of the next iteration.</p></li>
<li><p><strong>const_uncertainty</strong> (<em>float</em>) – Constant uncertainty in adu to add to all channels. Estimate for the
electronic noise present in the CCD camera.</p></li>
<li><p><strong>verbose</strong> (<em>boolean</em>) – If true, print out additional information during the fitting process.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="euv_fitting.calibrate.calibrators.Calibrator.fit_iter">
<span class="sig-name descname"><span class="pre">fit_iter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outlier_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#euv_fitting.calibrate.calibrators.Calibrator.fit_iter" title="Permalink to this definition">#</a></dt>
<dd><p>Fits current solution array. Handles outlier removal and function fitting.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>func</strong> (<em>callable</em>) – <p>Calibration function, takes in x and returns y. Must have the signature:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">func</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span><span class="o">.</span>
</pre></div>
</div>
</p></li>
<li><p><strong>outlier_sigma</strong> (<em>{float</em><em>, </em><em>None}</em>) – Number of sigmas away a point can be before being removed. Lower
values indicate more aggressive outlier removal. See the
remove_outliers function for more details. If None, no outlier
removal is completed.</p></li>
<li><p><strong>verbose</strong> (<em>boolean</em>) – If true, print out additional information during the fitting process.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="euv_fitting.calibrate.calibrators.Calibrator.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#euv_fitting.calibrate.calibrators.Calibrator.plot" title="Permalink to this definition">#</a></dt>
<dd><p>plots calibration function with x on x-axis and y on y-axis</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="euv_fitting.calibrate.calibrators.Calibrator.remove_outliers">
<span class="sig-name descname"><span class="pre">remove_outliers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outlier_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#euv_fitting.calibrate.calibrators.Calibrator.remove_outliers" title="Permalink to this definition">#</a></dt>
<dd><p>Removes outliers from solution_arr and order_data using Leave One Out.</p>
<p>This function removes one point from the calibration,
completes the calibration process without that point,
and tests to see if the removed point is now outlier_sigma away. If multiple points are outliers, the worst point is removed and the process begins again.</p>
<p>The number of sigmas away the removed point is is computed by:</p>
<p>n_sigmas_away = removed_line_residual / (removed_line_uncertainty ** 2 + calibration_uncertainty ** 2) ** (1/2)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>func</strong> (<em>callable</em>) – <p>Calibration function, takes in x and returns y. Must have the signature:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">func</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span><span class="o">.</span>
</pre></div>
</div>
</p></li>
<li><p><strong>outlier_sigma</strong> (<em>{float</em><em>, </em><em>None}</em>) – Number of sigmas away a point can be before being removed. Lower
values indicate more aggressive outlier removal. If None, no outlier
removal is completed.</p></li>
<li><p><strong>verbose</strong> (<em>boolean</em>) – If true, print out additional information during the fitting process.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="euv_fitting.calibrate.calibrators.Calibrator.residual_plot">
<span class="sig-name descname"><span class="pre">residual_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Residual</span> <span class="pre">Plot'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linestyle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'-b'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#euv_fitting.calibrate.calibrators.Calibrator.residual_plot" title="Permalink to this definition">#</a></dt>
<dd><p>plots residuals, uncertainties, and confidence bands at n_sigma</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="euv_fitting.calibrate.calibrators.Calibrator.solve_chi_square">
<span class="sig-name descname"><span class="pre">solve_chi_square</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.002</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#euv_fitting.calibrate.calibrators.Calibrator.solve_chi_square" title="Permalink to this definition">#</a></dt>
<dd><p>Finds value of systematic uncertainty that gets the chi-squared as close
to target as possible.</p>
<p>If the chi square is already less than target, returns 0.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>func</strong> (<em>callable</em>) – <p>Calibration function, takes in x and returns y. Must have the signature:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">func</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span><span class="o">.</span>
</pre></div>
</div>
</p></li>
<li><p><strong>target</strong> (<em>float</em>) – Goal value of chi_squared, typically 1.</p></li>
<li><p><strong>x0</strong> (<em>Float</em>) – Initial guess of systematic uncertainty.</p></li>
<li><p><strong>verbose</strong> (<em>boolean</em>) – If true, print out additional information during the fitting process.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="euv_fitting.calibrate.calibrators.Calibrator.uncertainty_fit">
<span class="sig-name descname"><span class="pre">uncertainty_fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">popt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pcov</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#euv_fitting.calibrate.calibrators.Calibrator.uncertainty_fit" title="Permalink to this definition">#</a></dt>
<dd><p>Finds the best fit parameters given the uncertainty in x, y, and systematics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>popt</strong> (<em>array-like</em>) – Calibration coefficients only considering y-uncertainty.
Must have length N, where N is the number of calibration parameters.</p></li>
<li><p><strong>pcov</strong> (<em>array-like</em>) – Calibration matrix only considering y-uncertainty.
Must have shape N x N, where N is the number of calibration parameters.</p></li>
<li><p><strong>func</strong> (<em>callable</em>) – <p>Calibration function, takes in x and returns y. Must have the signature:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">func</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span><span class="o">.</span>
</pre></div>
</div>
</p></li>
<li><p><strong>verbose</strong> (<em>boolean</em>) – If true, print out additional information during the fitting process.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>popt</strong> (<em>array-like</em>) – Array of the best calibration parameters given the uncertainty in x, y, and systematics.</p></li>
<li><p><strong>pcov</strong> (<em>array-like</em>) – Array of the covariance matrix given the uncertainty in x, y, and systematics.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div></blockquote>
</section>
<section id="distance-calibrator">
<h2><a class="reference internal" href="#euv_fitting.calibrate.calibrators.Distance_Calibrator" title="euv_fitting.calibrate.calibrators.Distance_Calibrator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Distance_Calibrator</span></code></a><a class="headerlink" href="#distance-calibrator" title="Permalink to this heading">#</a></h2>
<p>Currently, the only supported method of line identification is <strong>Distance Calibration</strong>,
which analyzes the relative distance between peaks to identify well-known calibration lines.
In any given spectra, the channel distance between peaks stays relatively constant.
Arrays of well known peaks for Ne, Bkg, and Ar files are stored in distance files.</p>
<p>For example the distance file for neon looks like:</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">ne_dis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;../euv_fitting/calibrate/dis_files/NeO_distances.csv&#39;</span><span class="p">,</span> <span class="n">delimiter</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">ne_dis</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[[ 7.57640000e+00  4.00000000e-04 -1.76901644e+02]
 [ 8.80929000e+00  1.40000000e-04  0.00000000e+00]
 [ 9.75020000e+00  4.00000000e-04  1.27844000e+02]
 [ 1.11136000e+01  1.80000000e-03  3.04301000e+02]
 [ 1.16691000e+01  5.00000000e-04  3.73434000e+02]
 [ 1.27676000e+01  7.00000000e-04  5.06394000e+02]
 [ 1.43314000e+01  7.00000000e-04  6.87520000e+02]
 [ 1.47138000e+01  7.00000000e-04  7.30589000e+02]
 [ 1.50101000e+01  5.00000000e-04  7.63667000e+02]
 [ 1.76186000e+01  2.80000000e-04  1.04329000e+03]
 [ 1.95004000e+01  8.00000000e-04  1.23294000e+03]
 [ 2.33382000e+01  1.00000000e-03  1.60221000e+03]
 [ 2.45404000e+01  3.40000000e-04  1.71233000e+03]
 [ 2.55352000e+01  1.40000000e-03  1.80123000e+03]]
</pre></div>
</div>
</div>
</div>
<p>Each row represents a different calibration line. The first and second column
are the wavelength and wavelength uncertainty of the line. The last column is the
channel distance from a given line to the reference line.
For neon, the reference line is 8.80929 nm, as indicated by the 0 in the last column
(the distance from the reference line to itself has to be 0). <cite>Distance_Calibrator.calibrate()</cite>
tries each peak in a spectra as the reference line, and looks for other peaks
at the channel distances given in the calibration file.</p>
<dl class="py class">
<dt class="sig sig-object py" id="euv_fitting.calibrate.calibrators.Distance_Calibrator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Distance_Calibrator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">element</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Ne'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_peaks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hdf_dataset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gauss_locs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gaussian'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_poly</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#euv_fitting.calibrate.calibrators.Distance_Calibrator" title="Permalink to this definition">#</a></dt>
<dd><p>Current (as of 7/1/2022) preferred calibrator. Takes in 1d array of intensity values,
fits it with a sum-of-gaussians (multipeakgaussian), and identifies features
based on their relative positions.</p>
<dl class="py method">
<dt class="sig sig-object py" id="euv_fitting.calibrate.calibrators.Distance_Calibrator.calibrate">
<span class="sig-name descname"><span class="pre">calibrate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#euv_fitting.calibrate.calibrators.Distance_Calibrator.calibrate" title="Permalink to this definition">#</a></dt>
<dd><p>Tries each peak as the reference line and chooses the best match.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tolerance</strong> (<em>float</em>) – Maximum channel distance that can still yield a match.</p></li>
<li><p><strong>outfile</strong> (<em>string</em>) – File location to store data.</p></li>
<li><p><strong>return_dict</strong> (<em>dict</em>) – If given, will store calibration data in [‘data’] key of the dictionary.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>solution_arr</strong> – Identified lines and their channel positions. Each row in the array has form
[wavelength, wavelength_uncertainty, channel, channel_uncertainty]. This array is also stored in
self.solution_arr for later use.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array-like</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="euv_fitting.calibrate.calibrators.Distance_Calibrator.improve_calibration">
<span class="sig-name descname"><span class="pre">improve_calibration</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ref_ch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#euv_fitting.calibrate.calibrators.Distance_Calibrator.improve_calibration" title="Permalink to this definition">#</a></dt>
<dd><p>Checks to see if, given the lines that have been identified so far,
any lines currently lie on the calibration curve. If so, it adds them to
the detected lines.</p>
</dd></dl>

</dd></dl>

</section>
</section>


                </article>
              
              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="peakfitting.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Peak Fitters</p>
      </div>
    </a>
    <a class="right-next"
       href="uncertainty.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Uncertainties</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calibration-process">Calibration Process</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calibrator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Calibrator</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#euv_fitting.calibrate.calibrators.Calibrator"><code class="docutils literal notranslate"><span class="pre">Calibrator</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#euv_fitting.calibrate.calibrators.Calibrator.confidence_bands"><code class="docutils literal notranslate"><span class="pre">Calibrator.confidence_bands()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#euv_fitting.calibrate.calibrators.Calibrator.eval_chi_square"><code class="docutils literal notranslate"><span class="pre">Calibrator.eval_chi_square()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#euv_fitting.calibrate.calibrators.Calibrator.fit"><code class="docutils literal notranslate"><span class="pre">Calibrator.fit()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#euv_fitting.calibrate.calibrators.Calibrator.fit_iter"><code class="docutils literal notranslate"><span class="pre">Calibrator.fit_iter()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#euv_fitting.calibrate.calibrators.Calibrator.plot"><code class="docutils literal notranslate"><span class="pre">Calibrator.plot()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#euv_fitting.calibrate.calibrators.Calibrator.remove_outliers"><code class="docutils literal notranslate"><span class="pre">Calibrator.remove_outliers()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#euv_fitting.calibrate.calibrators.Calibrator.residual_plot"><code class="docutils literal notranslate"><span class="pre">Calibrator.residual_plot()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#euv_fitting.calibrate.calibrators.Calibrator.solve_chi_square"><code class="docutils literal notranslate"><span class="pre">Calibrator.solve_chi_square()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#euv_fitting.calibrate.calibrators.Calibrator.uncertainty_fit"><code class="docutils literal notranslate"><span class="pre">Calibrator.uncertainty_fit()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#distance-calibrator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Distance_Calibrator</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#euv_fitting.calibrate.calibrators.Distance_Calibrator"><code class="docutils literal notranslate"><span class="pre">Distance_Calibrator</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#euv_fitting.calibrate.calibrators.Distance_Calibrator.calibrate"><code class="docutils literal notranslate"><span class="pre">Distance_Calibrator.calibrate()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#euv_fitting.calibrate.calibrators.Distance_Calibrator.improve_calibration"><code class="docutils literal notranslate"><span class="pre">Distance_Calibrator.improve_calibration()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div class="tocsection sourcelink">
    <a href="_sources/calibration.rst.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">
  <p class="copyright">
    
      © Copyright 2023 - Hunter Staiger.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">
  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.0.1.
    <br/>
  </p>
</div>
      
    </div>
  
  
    <div class="footer-items__end">
      
        <div class="footer-item"><p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.13.3.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>